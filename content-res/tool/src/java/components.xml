<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">
<!--
/**********************************************************************************
 * $URL:  $
 * $Id:  $
 ***********************************************************************************
 *
 * Copyright (c) 2003, 2004, 2005, 2006 The Sakai Foundation.
 *
 * Licensed under the Educational Community License, Version 1.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.opensource.org/licenses/ecl1.php
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 **********************************************************************************/
-->
<beans>
<bean id="linkDao"
    class="org.sakaiproject.contentres.impl.LinkDao">
		<property name="dataSource">
			<ref bean="javax.sql.LazyDataSource" />
		</property>
    </bean>
    
   <bean id="linkServiceImpl"
    class="org.sakaiproject.contentres.impl.LinkServiceImpl">
 		<property name="linkDao">
			<ref local="linkDao" />
		</property>
    </bean>   
    
    
  <!-- START NEW STUFF -->
  <!-- Register the Data Access Object as a Transactional Interceptor -->
  <bean id="org.sakaiproject.contentres.api.LinkService"
    class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">
    <property name="transactionManager"><ref
	bean="org.sakaiproject.springframework.orm.hibernate.GlobalTransactionManager"/>
    </property>
    <property name="transactionAttributes">
      <props>
	
	<prop key="get*">PROPAGATION_REQUIRED,readOnly</prop>
	<!--
	<prop key="find*">PROPAGATION_REQUIRED,readOnly</prop>
	-->
	<prop key="add*">PROPAGATION_REQUIRED</prop>
	<prop key="delete*">PROPAGATION_REQUIRED</prop>
	<prop key="*">PROPAGATION_REQUIRED</prop>
	<!--. not needed for this version of create .-->
	<!--<prop key="create*">PROPAGATION_REQUIRED</prop>-->
      </props>
    </property>
    <property name="target"><ref bean="linkServiceImpl"/></property>
  </bean>
</beans>