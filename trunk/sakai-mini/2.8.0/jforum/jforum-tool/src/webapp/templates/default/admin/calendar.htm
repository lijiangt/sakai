<!--
Title: Tigra Calendar
URL: http://www.softcomplex.com/products/tigra_calendar/
Version: 3.2
Date: 10/14/2002 (mm/dd/yyyy)
Note: Permission given to use this script in ANY kind of applications if
   header lines are left unchanged.
Note: Script consists of two files: calendar?.js and calendar.html
-->
<html>
<head>
<title>Select Date, Please.</title>
<style>
	td {font-family: Tahoma, Verdana, sans-serif; font-size: 12px;}
</style>
<script language="JavaScript">

// months as they appear in the calendar's title
var ARR_MONTHS = ["January", "February", "March", "April", "May", "June",
		"July", "August", "September", "October", "November", "December"];
// week day titles as they appear on the calendar
var ARR_WEEKDAYS = ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"];
// day week starts from (normally 0-Su or 1-Mo)
var NUM_WEEKSTART = 1;
// path to the directory where calendar images are stored. trailing slash req.
var STR_ICONPATH = './images/';

//alert('url string is '+String(window.location));
var re_url = new RegExp('datetime=(\\-?\\d+)');
//alert(re_url.exec(String(window.location)));
var reampm_url = new RegExp('ampmval=(\\-?\\w+)');
//alert('ampm is '+reampm_url.exec(String(window.location)));
var dt_current = (re_url.exec(String(window.location))
	? new Date(new Number(RegExp.$1)) : new Date());
	//alert('In calendar '+dt_current);

var ampm_val = (reampm_url.exec(String(window.location))
	? new String(RegExp.$1) : "AM");
	//alert('In calendar ampm is '+ampm_val);
	
var re_id = new RegExp('id=(\\d+)');
var num_id = (re_id.exec(String(window.location))
	? new Number(RegExp.$1) : 0);
	
var obj_caller = (window.opener ? window.opener.calendars[num_id] : null);
    
if (obj_caller && obj_caller.year_scroll) {
	// get same date in the previous year
	var dt_prev_year = new Date(dt_current);
	dt_prev_year.setFullYear(dt_prev_year.getFullYear() - 1);
	if (dt_prev_year.getDate() != dt_current.getDate())
		dt_prev_year.setDate(0);

	// get same date in the next year
	var dt_next_year = new Date(dt_current);
	dt_next_year.setFullYear(dt_next_year.getFullYear() + 1);
	if (dt_next_year.getDate() != dt_current.getDate())
		dt_next_year.setDate(0);
}

// get same date in the previous month
var dt_prev_month = new Date(dt_current);
dt_prev_month.setMonth(dt_prev_month.getMonth() - 1);
if (dt_prev_month.getDate() != dt_current.getDate())
	dt_prev_month.setDate(0);

// get same date in the next month
var dt_next_month = new Date(dt_current);
dt_next_month.setMonth(dt_next_month.getMonth() + 1);
if (dt_next_month.getDate() != dt_current.getDate())
	dt_next_month.setDate(0);

// get first day to display in the grid for current month
var dt_firstday = new Date(dt_current);
dt_firstday.setDate(1);
dt_firstday.setDate(1 - (7 + dt_firstday.getDay() - NUM_WEEKSTART) % 7);

// function passing selected date to calling window
function set_datetime(n_datetime, b_close) {
	if (!obj_caller) return;
	
    //alert(document.cal.ampm.value);


   var caltime = document.cal.hr.value+':'+document.cal.min.value+':00';

   	var dt_datetime = obj_caller.prs_time(
   			(document.cal ? caltime : ''),
   			new Date(n_datetime)
   	);

   	if (!dt_datetime) return;
   	if (b_close) {
   	//alert('after bclose '+dt_datetime);
   		window.close();

   		obj_caller.target.value = (document.cal
   			? obj_caller.gen_tsmp(dt_datetime) + ' ' + document.cal.ampm.value
   			: obj_caller.gen_date(dt_datetime) + ' ' + document.cal.ampm.value
   		);
   		//alert(obj_caller.target.value);
   	}
	else obj_caller.popup(dt_datetime.valueOf());


	/*var dt_datetime = obj_caller.prs_time(
		(document.cal ? document.cal.time.value : ''),
		new Date(n_datetime)
	);*/

	/*var caltime = document.cal.hr.value+':'+document.cal.min.value+':'+document.cal.sec.value;

	var dt_datetime = obj_caller.prs_time(
			(document.cal ? caltime : ''),
			new Date(n_datetime)
	);

	if (!dt_datetime) return;
	if (b_close) {
		window.close();
		obj_caller.target.value = (document.cal
			? obj_caller.gen_tsmp(dt_datetime)
			: obj_caller.gen_date(dt_datetime)
		);
	}
	else obj_caller.popup(dt_datetime.valueOf());*/
}

</script>
</head>
<body bgcolor="#FFFFFF" marginheight="5" marginwidth="5" topmargin="5" leftmargin="5" rightmargin="5">
<table class="clsOTable" cellspacing="0" border="0" width="100%">
<tr><td bgcolor="#4682B4">
<table cellspacing="1" cellpadding="3" border="0" width="100%">
<tr><td colspan="7"><table cellspacing="0" cellpadding="0" border="0" width="100%">
<tr>
<script language="JavaScript">
document.write(
'<td>'+(obj_caller&&obj_caller.year_scroll?'<a href="javascript:set_datetime('+dt_prev_year.valueOf()+')"><img src="'+STR_ICONPATH+'prev_year.gif" width="16" height="16" border="0" alt="previous year"></a>&nbsp;':'')+'<a href="javascript:set_datetime('+dt_prev_month.valueOf()+')"><img src="'+STR_ICONPATH+'prev.gif" width="16" height="16" border="0" alt="previous month"></a></td>'+
'<td align="center" width="100%"><font color="#ffffff">'+ARR_MONTHS[dt_current.getMonth()]+' '+dt_current.getFullYear() + '</font></td>'+
'<td><a href="javascript:set_datetime('+dt_next_month.valueOf()+')"><img src="'+STR_ICONPATH+'next.gif" width="16" height="16" border="0" alt="next month"></a>'+(obj_caller && obj_caller.year_scroll?'&nbsp;<a href="javascript:set_datetime('+dt_next_year.valueOf()+')"><img src="'+STR_ICONPATH+'next_year.gif" width="16" height="16" border="0" alt="next year"></a>':'')+'</td>'
);
</script>
</tr>
</table></td></tr>
<tr>
<script language="JavaScript">

// print weekdays titles
for (var n=0; n<7; n++)
	document.write('<td bgcolor="#87cefa" align="center"><font color="#ffffff">'+ARR_WEEKDAYS[(NUM_WEEKSTART+n)%7]+'</font></td>');
document.write('</tr>');

// print calendar table
var dt_current_day = new Date(dt_firstday);
while (dt_current_day.getMonth() == dt_current.getMonth() ||
	dt_current_day.getMonth() == dt_firstday.getMonth()) {
	// print row heder
	document.write('<tr>');
	for (var n_current_wday=0; n_current_wday<7; n_current_wday++) {
		if (dt_current_day.getDate() == dt_current.getDate() &&
			dt_current_day.getMonth() == dt_current.getMonth())
			// print current date
			document.write('<td bgcolor="#ffb6c1" align="center" width="14%">');
		else if (dt_current_day.getDay() == 0 || dt_current_day.getDay() == 6)
			// weekend days
			document.write('<td bgcolor="#dbeaf5" align="center" width="14%">');
		else
			// print working days of current month
			document.write('<td bgcolor="#ffffff" align="center" width="14%">');

		document.write('<a href="javascript:set_datetime('+dt_current_day.valueOf() +', true);">');

		if (dt_current_day.getMonth() == this.dt_current.getMonth())
			// print days of current month
			document.write('<font color="#000000">');
		else
			// print days of other months
			document.write('<font color="#606060">');

		document.write(dt_current_day.getDate()+'</font></a></td>');
		dt_current_day.setDate(dt_current_day.getDate()+1);
	}
	// print row footer
	document.write('</tr>');
}
if (obj_caller && obj_caller.time_comp)

	document.write('<form onsubmit="javascript:set_datetime('+dt_current.valueOf()+', true)" name="cal"><tr><td colspan="7" bgcolor="#87CEFA"><font color="White" face="tahoma, verdana" size="2">Time: ');
	document.write('<select name="hr">');
	for (var i=1;i<13;i++)
	{
	  if (i < 10)
	  {
	  	  //<<<01/09/2008 Murthy - added the below code
	  	  var cur_hr = dt_current_day.getHours(); 
	  	  if (dt_current_day.getHours() > 12)
	  	  	cur_hr = dt_current_day.getHours() - 12; 
		  // >>>01/09/2008 Murthy
	  	  	
	      //01/09/2008 Murthy commented - if (i == dt_current_day.getHours())
	      if (i == cur_hr)
	      {
	        document.write('<option value=\"0'+i+'\" selected>0'+i);
	      }
	      else
	      {
	        /*
			if (i == 8)
	        {
	          document.write('<option value=\"0'+i+'\" selected>0'+i);
	        }
	        else
	        {
			*/
	          document.write('<option value=\"0'+i+'\">0'+i);
	        //}
	      }

	  }
	  else
	  {
	    if (i == dt_current_day.getHours())
	    {
	      document.write('<option value=\"'+i+'\" selected>'+i);
	    }
	    else
	    {
	      document.write('<option value=\"'+i+'\">'+i);
	    }
	  }
	}
	document.write('</select>');
    document.write('<select name="min">');
	for (var i=0;i<60;i++)
	{
	  if (i < 10)
	  {
	  	  if (i == dt_current_day.getMinutes())
	  	  {
	  	    document.write('<option value=\"0'+i+'\" selected>0'+i);
	  	  }
	  	  else
	  	  {
	  	    document.write('<option value=\"0'+i+'\">0'+i);
	  	  }
	  }
	  	  else
	  	  {
	  	  if (i == dt_current_day.getMinutes())
	  	  {
	  	    document.write('<option value=\"'+i+'\" selected>'+i);
	  	  }
	  	  else
	  	  {
	  	    document.write('<option value=\"'+i+'\">'+i);
	  	  }
	  }
	}
	document.write('</select>');
    /*document.write('<select name="sec">');
	for (var i=0;i<60;i++)
	{
	  if (i < 10)
	  	  {
	  	  if (i == dt_current_day.getSeconds())
	  	  {
	  	    document.write('<option value=\"0'+i+'\" selected>0'+i);
	  	  }
	  	  else
	  	  {
		  	 document.write('<option value=\"0'+i+'\">0'+i);
	  	  }
	  	  }
	  	  else
	  	  {
	  	  if (i == dt_current_day.getSeconds())
	  	  {
	  	     document.write('<option value=\"'+i+'\" selected>'+i);
	  	  }
	  	  else
	  	  {
	  	    document.write('<option value=\"'+i+'\">'+i);
	  	  }
	      }
	}
	document.write('</select>');*/
	
	//<<<01/09/2008 Murthy added the below code
	if (ampm_val != "PM" || ampm_val != "AM") {
		if (dt_current_day.getHours() > 12)
			ampm_val = "PM";
	}	
	//>>>01/09/2008 Murthy	
		  
	document.write('<select name="ampm">');
	if (ampm_val == "AM")
	{
	  document.write('<option value=\"AM\" selected>AM');
	  document.write('<option value=\"PM\">PM');
	}
	else
	{
	  if (ampm_val == "PM")
	  {
	    document.write('<option value=\"AM\">AM');
	    document.write('<option value=\"PM\" selected>PM');
	  }
	  else
	  {
	  	  document.write('<option value=\"AM\" selected>AM');
	  	  document.write('<option value=\"PM\">PM');
	  }
	}

	document.write('</select>');
	document.write('</font></td></tr></form>');



</script>
</table></tr></td>
</table>
</body>
</html>

